<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Open Source Weather</title>
    <style>
        body { font-family: Arial, sans-serif; margin:0; padding:0; }
        #banner { background:#eef7ff; padding:12px; border-bottom:1px solid #cfe9ff; }
        #load { font-weight:600; }
        #forecast { margin-top:4px; font-size:0.9rem; color:#333; }
    </style>
</head>
<body>

<div id="banner">
    <div id="load">Loading weatherâ€¦</div>
    <div id="forecast"></div>
</div>

<script>
    const weatherEl = document.getElementById("load");
    const forecastEl = document.getElementById("forecast");

    // Assigning description of the weather condition to a number that corresponds the data.
    function weatherCodeToDesc(code) {
        const weatherDesc = {
            0: "Clear sky",
            1: "Mainly clear",
            2: "Partly cloudy",
            3: "Overcast",
            45: "Fog",
            48: "Depositing rime fog",
            51: "Light drizzle",
            53: "Moderate drizzle",
            55: "Dense drizzle",
            56: "Light freezing drizzle",
            57: "Dense freezing drizzle",
            61: "Slight rain",
            63: "Moderate rain",
            65: "Heavy rain",
            66: "Light freezing rain",
            67: "Heavy freezing rain",
            71: "Slight snow",
            73: "Moderate snow",
            75: "Heavy snow",
            77: "Snow grains",
            80: "Slight rain showers",
            81: "Moderate rain showers",
            82: "Violent rain showers",
            85: "Slight snow showers",
            86: "Heavy snow showers",
            95: "Thunderstorm",
            96: "Thunderstorm with slight hail",
            99: "Thunderstorm with heavy hail"
        };
        return weatherDesc[code] || "Unknown";
    }

    // Ask permission for accessing location data (position will be organised as latitude and longitude) with location we know time as well.
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;

            // Featch the relevant latitude and longitude data from open meteo database
            // try - catch is a way to contain any error that might happen during running the code. It is type of if-else. If the code fails. Display error message.

            const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,weathercode&timezone=auto`;
            try {
                const res = await fetch(url);
                const data = await res.json();

                //Current weather constant should be displaying an emoji, temperature in C and descriptive weather according to the matching code we assigned.
                const cur = data.current_weather;
                weatherEl.textContent = `ðŸŒ¤ï¸ Temp: ${cur.temperature}Â°C â€” ${weatherCodeToDesc(cur.weathercode)}`;


            } catch (err) {
                weatherEl.textContent = "Failed to fetch weather data.";
                console.error(err);
            }

        }, err => {
            weatherEl.textContent = "Location access denied or unavailable.";
            console.error(err);
        });
    } else {
        weatherEl.textContent = "Geolocation not supported.";
    }
</script>

</body>
</html>
